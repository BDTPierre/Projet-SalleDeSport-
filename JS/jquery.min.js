const nom = document.querySelector("#nomInput");
const prenom = document.querySelector("#prenomInput");
const email = document.querySelector("#emailInput");
const sujet = document.querySelector("#sujetInput");
const tel = document.querySelector("#telInput");
const message = document.querySelector("#messageTextArea");

/*---------------- Variables de Validation ---------------------------*/
let nomValid = false;
let prenomValid = false;
let emailValid = false;
let sujetValid = false;
let telValid = false;
let messageValid = false;

const userRegex = /^[a-zA-Z-]{3,23}$/;
const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
const PhoneNumberRegex = /^\+(?:\d{1,3})?\d{10}$/;
const SujetRegex = /^[^<>{}$]{3,200}$/;
const messageRegex = /^[^<>{}$]{24,}$/;

function addClass(element, regex, value) {
    if (regex.test(value)) {
      element.classList.add("is-valid");
      element.classList.remove("is-invalid");
    } else {
      element.classList.remove("is-valid");
      element.classList.add("is-invalid");
    }
  }
  
  nom.addEventListener("input", (e) => {
    addClass(nom, userRegex, e.target.value);
    if (nom.classList.contains("is-valid")) {
      nomValid = true;
    } else {
      nomValid = false;
    }
  })
  
  prenom.addEventListener("input", (e) => {
    addClass(prenom, userRegex, e.target.value);
    if (prenom.classList.contains("is-valid")) {
      prenomValid = true;
    } else {
      prenomValid = false;
    }
  })
  
  email.addEventListener("input", (e) => {
    addClass(email, emailRegex, e.target.value);
    if (email.classList.contains("is-valid")) {
      emailValid = true;
    } else {
      emailValid = false;
    }
  })
  
  sujet.addEventListener("input", (e) => {
    addClass(sujet, userRegex, e.target.value);
    if (sujet.classList.contains("is-valid")) {
      sujetValid = true;
    } else {
      sujetValid = false;
    }
  })
  
  tel.addEventListener("input", (e) => {
    const inputValue = e.target.value;
    const processedValue = inputValue.replace(/\s/g, '').replace(/^0/, '+33');
    e.target.value = processedValue;
  
    addClass(tel, PhoneNumberRegex, e.target.value);
  
    if (tel.classList.contains("is-valid")) {
      telValid = true;
    } else {
      telValid = false;
    }
  })
  
  message.addEventListener("input", (e) => {
    addClass(message, userRegex, e.target.value);
    if (message.classList.contains("is-valid")) {
      messageValid = true;
    } else {
      messageValid = false;
    }
  })